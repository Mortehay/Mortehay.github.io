function polygonStyleFunction(feature,resolution){return new ol.style.Style({stroke:new ol.style.Stroke({color:"blue",width:1}),fill:new ol.style.Fill({color:"rgba(0, 0, 255, 0.1)"}),text:createTextStyle(feature,resolution,myDom.polygons)})}function lineStyleFunction(feature,resolution){return new ol.style.Style({stroke:new ol.style.Stroke({color:"green",width:2}),text:createTextStyle(feature,resolution,myDom.lines)})}function pointStyleFunction(feature,resolution){return new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"rgba(255, 0, 0, 0.1)"}),stroke:new ol.style.Stroke({color:"red",width:1})}),text:createTextStyle(feature,resolution,myDom.points)})}function stringDivider(str,width,spaceReplacer){if(str.length>width){for(var p=width;p>0&&" "!=str[p]&&"-"!=str[p];)p--;if(p>0){var left;left="-"==str.substring(p,p+1)?str.substring(0,p+1):str.substring(0,p);var right=str.substring(p+1);return left+spaceReplacer+stringDivider(right,width,spaceReplacer)}}return str}var myDom={points:{text:document.getElementById("points-text"),align:document.getElementById("points-align"),baseline:document.getElementById("points-baseline"),rotation:document.getElementById("points-rotation"),font:document.getElementById("points-font"),weight:document.getElementById("points-weight"),size:document.getElementById("points-size"),offsetX:document.getElementById("points-offset-x"),offsetY:document.getElementById("points-offset-y"),color:document.getElementById("points-color"),outline:document.getElementById("points-outline"),outlineWidth:document.getElementById("points-outline-width"),maxreso:document.getElementById("points-maxreso")},lines:{text:document.getElementById("lines-text"),align:document.getElementById("lines-align"),baseline:document.getElementById("lines-baseline"),rotation:document.getElementById("lines-rotation"),font:document.getElementById("lines-font"),weight:document.getElementById("lines-weight"),size:document.getElementById("lines-size"),offsetX:document.getElementById("lines-offset-x"),offsetY:document.getElementById("lines-offset-y"),color:document.getElementById("lines-color"),outline:document.getElementById("lines-outline"),outlineWidth:document.getElementById("lines-outline-width"),maxreso:document.getElementById("lines-maxreso")},polygons:{text:document.getElementById("polygons-text"),align:document.getElementById("polygons-align"),baseline:document.getElementById("polygons-baseline"),rotation:document.getElementById("polygons-rotation"),font:document.getElementById("polygons-font"),weight:document.getElementById("polygons-weight"),size:document.getElementById("polygons-size"),offsetX:document.getElementById("polygons-offset-x"),offsetY:document.getElementById("polygons-offset-y"),color:document.getElementById("polygons-color"),outline:document.getElementById("polygons-outline"),outlineWidth:document.getElementById("polygons-outline-width"),maxreso:document.getElementById("polygons-maxreso")}},getText=function(feature,resolution,dom){var type=dom.text.value,maxResolution=dom.maxreso.value,text=feature.get("name");return resolution>maxResolution?text="":"hide"==type?text="":"shorten"==type?text=text.trunc(12):"wrap"==type&&(text=stringDivider(text,16,"\n")),text},createTextStyle=function(feature,resolution,dom){var align=dom.align.value,baseline=dom.baseline.value,size=dom.size.value,offsetX=parseInt(dom.offsetX.value,10),offsetY=parseInt(dom.offsetY.value,10),weight=dom.weight.value,rotation=parseFloat(dom.rotation.value),font=weight+" "+size+" "+dom.font.value,fillColor=dom.color.value,outlineColor=dom.outline.value,outlineWidth=parseInt(dom.outlineWidth.value,10);return new ol.style.Text({textAlign:align,textBaseline:baseline,font:font,text:getText(feature,resolution,dom),fill:new ol.style.Fill({color:fillColor}),stroke:new ol.style.Stroke({color:outlineColor,width:outlineWidth}),offsetX:offsetX,offsetY:offsetY,rotation:rotation})},vectorPolygons=new ol.layer.Vector({source:new ol.source.Vector({url:"data/geojson/polygon-samples.geojson",format:new ol.format.GeoJSON}),style:polygonStyleFunction}),vectorLines=new ol.layer.Vector({source:new ol.source.Vector({url:"data/geojson/line-samples.geojson",format:new ol.format.GeoJSON}),style:lineStyleFunction}),vectorPoints=new ol.layer.Vector({source:new ol.source.Vector({url:"data/geojson/point-samples.geojson",format:new ol.format.GeoJSON}),style:pointStyleFunction}),map=new ol.Map({layers:[new ol.layer.Tile({source:new ol.source.MapQuest({layer:"osm"})}),vectorPolygons,vectorLines,vectorPoints],target:"map",view:new ol.View({center:[-8161939,6095025],zoom:8})});document.getElementById("refresh-points")&&document.getElementById("refresh-points").addEventListener("click",function(){vectorPoints.setStyle(pointStyleFunction)}),document.getElementById("refresh-lines")&&document.getElementById("refresh-lines").addEventListener("click",function(){vectorLines.setStyle(lineStyleFunction)}),document.getElementById("refresh-polygons")&&document.getElementById("refresh-polygons").addEventListener("click",function(){vectorPolygons.setStyle(polygonStyleFunction)}),String.prototype.trunc=String.prototype.trunc||function(n){return this.length>n?this.substr(0,n-1)+"...":this.substr(0)};